/*
 * Your Stylesheet
 *
 * This stylesheet is loaded when Atom starts up and is reloaded automatically
 * when it is changed.
 *
 * If you are unfamiliar with LESS, you can read more about it here:
 * http://www.lesscss.org
 */

@import "syntax-variables";
@import "ui-variables";

@import "packages/red-wavy-underline/styles/red-wavy-underline";

// Change the cursor to an underline
// atom-text-editor::shadow .cursor, atom-text-editor .cursor {
//   border-left: none;
//   border-bottom: 2px solid #526fff;
// }

.theme-one-light-ui, .theme-one-dark-ui, .theme-atom-material-ui {
  .advanced-open-file { font-size: 16px; }
  .git-Panel { font-size: 16px; }
  .status-bar { font-size: 16px; }
  .tab-bar { font-size: 16px; }
  .tree-view { font-size: 16px; }
}

// Make the line number portion of the gutter a larger minimum width so that the gutter doesn't
// grow and shrink on tiny files
// atom-text-editor::shadow .gutter .line-number {
//     min-width: 100px;
// }

// Set the font size larger only in editors in the active pane
// .pane.active {
//   atom-text-editor {
//     font-size: 20px;
//   }
// }

.tree-view .selected:before {
  background: hsla(0, 0%, 100%, .2); // show lines underneath
}

.tree-view .directory {
  & > .list-item:before {
    visibility: hidden; // hide arrows
  }

  .selected > .header.list-item ~ .entries.list-tree {
    background: linear-gradient(to right, transparent 24px, darken(@base-background-color, 30%) 24px, darken(@base-background-color, 30%) 25px, transparent 25px);
  }

  .header.list-item:hover ~ .entries.list-tree {
    background: linear-gradient(to right, transparent 24px, @text-color 24px, @text-color 25px, transparent 25px);
  }
}

// Highlights the cursor line
atom-text-editor::shadow {
  .cursor-line {
    background-color: @background-color-highlight;
  }
}

// Displays an error background shading behind spelling errors
//
// atom-text-editor::shadow .misspelling {
//   background-color: @background-color-error;
//   opacity: 0.4;
//   border-radius: 6px;
//   border: none;
// }

// Un-italicizes comments
atom-text-editor::shadow {
  .comment {
    font-style: normal;
  }
}

// Makes the cursor pulse instead of blink
atom-text-editor, atom-text-editor::shadow {
  .cursor {
    transition: opacity 0.5s;
  }
}

// Makes the cursor not blink at all
// atom-text-editor::shadow {
//   .cursors.blink-off .cursor {
//     opacity: 1;
//   }
// }

// Un-italicizes code markup in Markdown
atom-text-editor::shadow {
  .markup.raw.gfm {
    font-style: normal;
    color: @syntax-color-keyword;
  }
}

// Brightens the gutter diff indicators to make them more visible
.diff-icon(@color) {
  background-color: fade(@color, 60%);

  &:before {
    color: contrast(fade(@color, 60%));
  }
}

.diff-border(@color) {
  border-color: lighten(@color, 15%);
  border-left-width: 4px;
}

@gutter-padding: 15px;

atom-text-editor::shadow {
  .gutter .line-number {
    padding-left: @gutter-padding;

    &.git-line-added {
      .diff-border(@text-color-success);
      padding-left: @gutter-padding - 4;
    }

    &.git-line-modified {
      .diff-border(@text-color-warning);
      padding-left: @gutter-padding - 4;
    }

    &.git-line-removed {
      .diff-border(@text-color-error);
      padding-left: @gutter-padding;
    }
  }

  .gutter.git-diff-icon .line-number {
    &.git-line-added {
      .diff-icon(@text-color-success);
    }

    &.git-line-modified {
      .diff-icon(@text-color-warning);
    }

    &.git-line-removed {
      .diff-icon(@text-color-error);
    }
  }
}

// Makes the bracket matcher highlight more noticeable
atom-text-editor::shadow {
  .bracket-matcher .region {
    border-bottom: 2px solid blue;
  }
}

// Replaces the atom-lint error highlight with the red wavy underline
.lint .violation-border.violation-warning {
  .red-wavy-underline;
}

// Highlights trailing whitespace except on the cursor line
atom-text-editor::shadow {
  div.line:not(.cursor-line) {
    .trailing-whitespace {
      background-color: @background-color-error;
      color: contrast(@background-color-error);
    }
  }
}

// Disable the close icon on file tabs
// .tab .close-icon {
//   display: none;
// }

// https://discuss.atom.io/t/crazy-3d-angled-tree-view/18765
#atom-perspective() {
  @viewing-distance: 12in;
  @rotation: 20deg;

  .tree-view-scroller {
    transform: translateY(-10vh) perspective(@viewing-distance) rotateY(@rotation);
    padding-top: 12vh;
    padding-bottom: 12vh;
    transform-origin: left;
    width: 120%;
    height: 120%;
  }
  body /deep/ atom-text-editor-minimap {
    transform: perspective(@viewing-distance) rotateY(-@rotation);
    transform-origin: right;
  }
}

// Comment or uncomment the next line to control whether the atom-perspective feature is enabled
// #atom-perspective;
